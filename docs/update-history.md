# HMoneta 项目升级历史

## V0.0.1-Alpha2 (2025年12月31日) - 当前版本

### 最新优化

**UI交互优化**:
- 使用悬浮按钮替换原本新增分组按钮，提升用户操作体验
- 优化界面交互设计，增强用户操作的直观性和便捷性
- 改进按钮布局和视觉反馈

**现代化登录界面**:
- 全新重写登录界面，采用粒子效果背景和玻璃拟态设计
- 实现现代化动画效果和响应式设计
- 提供更优雅和用户友好的登录体验
- 优化视觉效果和交互反馈

**UI体验优化**:
- 将背景设置成透明，提升前端UI在夜晚模式的体验
- 优化界面在不同主题模式下的视觉效果
- 改善用户在夜晚环境下的使用体验
- 提升整体视觉一致性和现代感

**认证流程优化**:
- 在前端 main.js 中增加认证状态检查
- 提升用户认证流程的用户体验
- 优化应用启动时的认证状态管理
- 改进用户体验流程的连贯性

**版本更新**:
- 项目版本从 V0.0.1-Alpha 升级至 V0.0.1-Alpha2
- 包含稳定性改进和用户体验优化
- 集成最新的UI设计改进和交互优化

### 重要里程碑

- **2025-12-31**: 发布 v0.0.1-Alpha2 版本，专注UI体验和认证流程优化
  - 实现现代化登录界面，包含粒子效果和玻璃拟态设计
  - 引入悬浮按钮交互模式，提升操作体验
  - 完成背景透明设计和夜晚模式优化
  - 优化认证流程和用户体验连贯性

## V0.0.1-Alpha (2025年12月)

### 重大功能增强

**证书有效期管理功能**:
- 自动存储证书有效期信息（notBefore/notAfter）
- 在DNS解析信息中展示证书有效期
- 提供证书有效期API查询接口
- 通过AcmeCertificationEntity的notBefore和notAfter字段管理证书有效期

**证书下载功能**:
- 新增证书下载API：`GET /hm/acme/download-cert/{domain}`
- 支持ZIP格式证书包下载
- 包含.key、.crt、.pem、.fullchain.pem等格式文件
- 提供完整的证书链打包和下载功能

**敏感字段过滤功能**:
- 通过@JwtExclude注解标记敏感字段，防止敏感信息泄露
- JWT工具类支持敏感字段过滤机制
- 增强系统安全性

**MDC日志追踪功能**:
- 使用MDC（Mapped Diagnostic Context）实现日志ID追踪
- 便于调试和问题定位
- 生成LOG_ID用于日志追踪

### 功能优化

- 证书有效期跟踪机制
    - 在AcmeCertificationEntity实体中添加notBefore和notAfter字段
    - 通过AcmeCerInfoResp响应实体传递证书有效期信息
    - 在DNS解析信息查询结果中包含证书有效期数据
- ACME证书申请异步处理机制
    - 使用@Async注解实现异步证书申请
    - 通过AcmeAsyncLogEntity实体跟踪异步任务日志
    - 支持任务状态跟踪和实时推送
    - 引入AcmeTaskContext任务上下文
- 插件管理功能增强
    - 支持ZIP格式插件上传
    - 插件版本检查和自动更新数据库记录
- WebSocket日志系统增强
    - 支持按服务订阅日志
    - 支持订阅所有日志
    - 实现ping/pong心跳机制

### 技术优化

- ACME证书申请过程优化
    - 添加登录重试机制，最多重试3次
    - DNS传播验证使用最多10次尝试验证，每次间隔10秒
    - 证书申请过程包含自动清理验证用DNS记录功能
- 安全机制改进
    - 从BCrypt改为MD5加盐加密存储密码
    - JWT工具类支持敏感字段过滤，通过@JwtExclude注解标记敏感字段
- 数据库操作优化
    - 修复了ACME证书申请过程中的数据库连接泄漏问题
    - 优化了异步任务中的数据库操作异常处理
- 异常处理增强
    - 增强了ACME证书申请过程中的网络异常处理
    - 添加了ACME挑战获取的异常处理机制
- JSON处理库变更
    - 使用tools.jackson进行JSON处理，替代标准的com.fasterxml.jackson

### 架构改进

- 定时任务配置优化
    - DNS更新任务仅在非开发环境运行（@Profile("!dev")）
    - 任务线程池使用HMScheduling-前缀命名
- 证书管理功能增强
    - 证书文件存储在 `certs/{domain}` 目录下
    - 支持.key、.crt、.pem、.fullchain.pem等格式
    - 证书打包功能支持ZIP格式压缩
    - 证书有效期信息存储在数据库中便于管理

### API端点更新

- 新增 ACME 管理 API
    - `POST /hm/acme/modify`: 修改 ACME 用户信息
    - `GET /hm/acme/apply`: 申请 SSL 证书
    - `GET /hm/acme/download-cert/{domain}`: 下载指定域名的证书包（ZIP格式）
- DNS解析信息API增强
    - 在DNS解析信息中包含证书有效期信息
    - 通过DnsResolveUrlResp实体的acmeCerInfo字段传递证书有效期
- WebSocket 实时日志 API 增强
    - 支持订阅特定服务日志
    - 支持全量日志订阅
    - 增加心跳检测机制

### 前端界面优化

- **现代化登录界面重写**: 完全重写了登录界面，采用粒子效果背景、玻璃拟态设计和现代化交互
  - 实现动画效果和响应式设计
  - 提供更优雅和用户友好的登录体验
  - 优化视觉效果和交互反馈
- **登录页面全屏显示**: 实现了登录页面的全屏显示模式，提升视觉效果和用户体验
- **UI交互优化**: 使用悬浮按钮替换传统按钮设计，提升操作直观性
- **用户体验改进**: 新增修改网址后直接触发DNS解析功能，提高用户体验

### 问题修复

- 修复腾讯云DNS插件中客户端未正确初始化的问题
- 解决了异步任务中可能出现的空指针异常
- 修复移除网址信息后，DNS解析未被同步移除的Bug
- 修复不能触发证书申请的Bug
- 修复证书下载接口的测试问题

### 文档更新

- 更新了项目文档，包括README、API文档和架构文档
- 完善了插件系统文档和开发指南
- 添加了证书下载功能的详细API文档
- 更新了技术栈版本信息和依赖说明

### 重要里程碑

- **2025-12-11**: 正式发布 v0.0.1-Alpha 版本，项目版本从0.0.1-SNAPSHOT升级

## V0.0.1-SNAPSHOT (2025年11月)

### 新增功能

- 基础DNS动态更新服务 (DDNS)
- 支持多种DNS提供商（通过插件系统）
- 前端Web管理界面 (Vue 3 + Vuetify)
- JWT用户认证系统
- WebSocket实时日志推送
- ACME协议支持（SSL证书自动申请和管理）